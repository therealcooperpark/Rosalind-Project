Almost got it figured out.
The current script works well, but is only correct 2/3 of the time.
Need an ugly script to just brute force the solution.
No idea about how to go about that, should probably put this one on the back burner
